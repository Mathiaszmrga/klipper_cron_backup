Loaded MCU 'can0' 107 commands (v0.10.0-635-gcfb633a0 / gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-11+rpi1+11) 2.31.1)
MCU 'can0' config: ADC_MAX=4095 BUS_PINS_i2c1_PA9_PA10=PA9,PA10 BUS_PINS_i2c1_PB6_PB7=PB6,PB7 BUS_PINS_i2c1_PB8_PB9=PB8,PB9 BUS_PINS_i2c2_PB10_PB11=PB10,PB11 BUS_PINS_i2c2_PB13_PB14=PB13,PB14 BUS_PINS_i2c3_PB3_PB4=PB3,PB4 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi3=PB4,PB5,PB3 CANBUS_FREQUENCY=1000000 CLOCK_FREQ=64000000 MCU=stm32g0b1xx PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_CAN=PB0,PB1 RESERVE_PINS_crystal=PF0,PF1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'can0' (1024 moves)
===== Config file =====
[adxl345]
cs_pin = can0:PB12
spi_software_sclk_pin = can0:PB10
spi_software_mosi_pin = can0:PB11
spi_software_miso_pin = can0:PB2
axes_map = x,y,z

[resonance_tester]
accel_chip = adxl345
probe_points = 
	60,60,20

[neopixel hat]
pin = PA8
chain_count = 18
color_order = GRB

[gcode_macro HAT_ON]
gcode = 
	SET_LED LED=hat GREEN=1 BLUE=1 RED=1

[gcode_macro HAT_OFF]
gcode = 
	SET_LED LED=hat GREEN=0 BLUE=0 RED=0

[neopixel underglow]
pin = PD5
chain_count = 24
color_order = GRB

[gcode_macro UNDERGLOW_ON]
gcode = 
	SET_LED LED=underglow GREEN=1 BLUE=1 RED=1

[gcode_macro UNDERGLOW_OFF]
gcode = 
	SET_LED LED=underglow GREEN=0 BLUE=0 RED=0

[gcode_macro NEOPIXEL_DISPLAY]
gcode = 
	{% set led = params.LED %}
	{% set type = params.TYPE %}
	{% set mode = params.MODE %}
	{% set my_neopixel = printer.configfile.config['neopixel ' ~ led] %}
	
	{% if mode == 'progress' %}
	{% for i in range(my_neopixel.chain_count|int) %}
	SET_LED_TEMPLATE LED={led} INDEX={i+1} TEMPLATE={'led_' ~ type ~ '_' ~ mode} param_led_num={i+1} param_led_total={my_neopixel.chain_count|int}
	{% endfor %}
	{% endif %}
	{% if mode == 'glow' %}
	SET_LED_TEMPLATE LED={led} TEMPLATE={'led_' ~ type ~ '_' ~ mode}
	{% endif %}

[display_template led_extruder_temp_glow]
text = 
	{% if printer.extruder.target > 0.0 %}
	{%  set temp = printer.extruder.target %}
	{% else %}
	{% set temp = printer.configfile.config.extruder.max_temp %}
	{% endif %}
	{% set ratio = printer.extruder.temperature / temp|float %}
	{ratio}, 0.0, {1-ratio}, 0.0

[display_template led_extruder_temp_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% if printer.extruder.target > 0.0 %}
	{%  set temp = printer.extruder.target %}
	{% else %}
	{% set temp = printer.configfile.config.extruder.max_temp %}
	{% endif %}
	{% set ratio = printer.extruder.temperature / temp|float %}
	{% set led_ratio = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	{led_ratio}, 0.0, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[display_template led_bed_temp_glow]
text = 
	{% if printer.heater_bed.target > 0.0 %}
	{%  set temp = printer.heater_bed.target %}
	{% else %}
	{% set temp = printer.configfile.config.heater_bed.max_temp %}
	{% endif %}
	{% set ratio = printer.heater_bed.temperature / temp|float %}
	{ratio}, 0.0, {1-ratio}, 0.0

[display_template led_bed_temp_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% if printer.heater_bed.target > 0.0 %}
	{%  set temp = printer.heater_bed.target %}
	{% else %}
	{% set temp = printer.configfile.config.heater_bed.max_temp %}
	{% endif %}
	{% set ratio = printer.heater_bed.temperature / temp|float %}
	{% set led_ratio = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	{led_ratio}, 0.0, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[display_template led_print_percent_glow]
text = 
	{% set ratio = printer.virtual_sdcard.progress %}
	0.0, {ratio}, 0.0, 0.0

[display_template led_print_percent_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% set ratio = printer.virtual_sdcard.progress %}
	{% set led_ratio   = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	0.0, {led_ratio}, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[display_template led_printer_speed_glow]
text = 
	{% set ratio  = printer.motion_report.live_velocity|float /  printer.configfile.config.printer.max_velocity|float %}
	0.0, {ratio}, 0.0, 0.0

[display_template led_printer_speed_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% set ratio  = printer.motion_report.live_velocity|float /  printer.configfile.config.printer.max_velocity|float %}
	{% set led_ratio    = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	0.0, {led_ratio}, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[gcode_macro _PRINT_START]
gcode = 
	{% set bedtemp = params.BED|int %}
	{% set hotendtemp = params.HOTEND|int %}
	{% set filament_profile = params.FILID|string %}
	G21
	G90
	M83
	G28
	G1 Z20 F1000
	M190 S{bedtemp}
	M109 S{hotendtemp}
	G28 Z
	_PRIME_LINE
	RESPOND TYPE=command MSG="Print start"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_starting"
	
	
	{% if filament_profile == 'PLA_LOUD' %}
	SET_PRESSURE_ADVANCE ADVANCE=0.045
	SET_FAN_SPEED FAN=boostFans SPEED=100
	RESPOND TYPE=command MSG="{filament_profile} - Boost fans 100%"
	{% elif filid == 'PLA_STANDARD' %}
	SET_PRESSURE_ADVANCE ADVANCE=0.045
	SET_FAN_SPEED FAN=boostFans SPEED=0
	RESPOND TYPE=command MSG="{filament_profile} - Boost fans 0%"
	{% elif filid == 'ABS' %}
	SET_FAN_SPEED FAN=boostFans SPEED=0
	RESPOND TYPE=command MSG="{filament_profile} - Boost fans 100%"
	{% endif %}
	
	NEOPIXEL_DISPLAY LED=underglow TYPE=print_percent MODE=progress

[gcode_macro _PRINT_END]
gcode = 
	M400
	G92 E0
	G1 E-4.0 F3600
	G91
	SET_FAN_SPEED FAN=boostFans SPEED=0
	RESPOND TYPE=command MSG="Print end"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_done"
	NEOPIXEL_DISPLAY LED=underglow TYPE=print_percent MODE=glow
	
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 20) %}
	{% set z_safe = 20 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	TURN_OFF_HEATERS
	M107
	G90
	G0 X60 Y{max_y} F3600
	DISABLE_STEPPERS
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro PAUSE]
rename_existing = PAUSE_BASE
gcode = 
	PAUSE_BASE
	_TOOLHEAD_PARK_PAUSE_CANCEL
	RESPOND TYPE=command MSG="Print pause"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_paused"

[gcode_macro RESUME]
rename_existing = RESUME_BASE
gcode = 
	
	{% set extrude = printer['gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL'].extrude %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	{% if printer.extruder.can_extrude|lower == 'true' %}
	M83
	G1 E{extrude} F2100
	{% if printer.gcode_move.absolute_extrude |lower == 'true' %} M82 {% endif %}
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	RESPOND TYPE=command MSG="Print resume"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_resuming"

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
variable_park = True
gcode = 
	
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	G90
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 20) %}
	{% set z_safe = 20 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	G0 Z{z_safe} F3600
	M107
	G0 X60 Y{max_y} F3600
	DISABLE_STEPPERS
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	SET_FAN_SPEED FAN=boostFans SPEED=0
	{% if printer.pause_resume.is_paused|lower == 'false' and park|lower == 'true'%}
	_TOOLHEAD_PARK_PAUSE_CANCEL
	{% endif %}
	TURN_OFF_HEATERS
	SDCARD_RESET_FILE
	CANCEL_PRINT_BASE
	RESPOND TYPE=command MSG="Print cancel"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_cancelled"

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
variable_extrude = 1.0
gcode = 
	
	
	{% set x_park = printer.toolhead.axis_maximum.x|float - 5.0 %}
	{% set y_park = printer.toolhead.axis_maximum.y|float - 5.0 %}
	{% set z_park_delta = 2.0 %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% if act_z < (max_z - z_park_delta) %}
	{% set z_safe = z_park_delta %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	{% if printer.extruder.can_extrude|lower == 'true' %}
	M83
	G1 E-{extrude} F2100
	{% if printer.gcode_move.absolute_extrude |lower == 'true' %} M82 {% endif %}
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G91
	G1 Z{z_safe} F900
	G90
	G1 X{x_park} Y{y_park} F6000
	{% if printer.gcode_move.absolute_coordinates|lower == 'false' %} G91 {% endif %}
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro DISABLE_STEPPERS]
description = Disable the steppers
gcode = 
	M18
	RESPOND TYPE=command MSG="Steppers disabled"

[gcode_macro LOAD_FILAMENT]
gcode = 
	M83
	G1 E30 F300
	G1 E15 F150
	M82
	RESPOND TYPE=command MSG="Load filament"

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	M83
	G1 E10 F300
	G1 E-40 F1800
	M82
	RESPOND TYPE=command MSG="Unload filament"

[gcode_macro _TALKETEMP]
gcode = 
	{% set TEMPE = params.TEMPE|int %}
	RESPOND TYPE=command MSG="Extruder temperature: {TEMPE}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="extruder_temperature_{TEMPE}"

[gcode_macro _TALKBTEMP]
gcode = 
	{% set TEMPB = params.TEMPB|int %}
	RESPOND TYPE=command MSG="Bed temperature: {TEMPB}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="bed_temperature_{TEMPB}"

[gcode_macro _TALKFILSET]
gcode = 
	{% set FILSET = params.FILSET|string %}
	RESPOND TYPE=command MSG="Slicer profile: {FILSET}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="slicer_filament_settings_{FILSET}"

[gcode_macro _TALKLHEIGHT]
gcode = 
	{% set LHEIGHT = params.LHEIGHT|string %}
	RESPOND TYPE=command MSG="Layer height: {LHEIGHT}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="layer_height_{LHEIGHT}"

[gcode_shell_command SPEAK]
command = espeak
timeout = 30
verbose = false

[delayed_gcode connected]
initial_duration = 1
gcode = 
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="Printer_ready"

[gcode_macro LOWERBED]
gcode = 
	G28
	G1 Z10 F1000

[gcode_macro _PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F1000
	
	G1 X120 Y120 Z0.28 F5000.0
	G1 X5 Y120 Z0.28 F1500.0 E15
	G1 X5 Y120 Z0.28 F5000.0
	G1 X120 Y120 Z0.28 F1500.0 E30
	G92 E0
	G1 Z2.0 F1000

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[temperature_sensor SKR_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[temperature_sensor thermexp]
sensor_type = temperature_mcu
sensor_mcu = thermexp
min_temp = 0
max_temp = 100

[temperature_sensor toolhead_MCU]
sensor_type = temperature_mcu
sensor_mcu = can0
min_temp = 0
max_temp = 100

[temperature_sensor chamber]
sensor_type = Generic 3950
sensor_pin = thermexp:PA3
min_temp = 0
max_temp = 100

[temperature_fan Stepper_Left]
pin = PC6
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.3
sensor_type = Generic 3950
min_temp = 0
max_temp = 100
sensor_pin = thermexp:PA5
pullup_resistor = 4700
control = pid
pid_kp = 28.182
pid_ki = 1.978
pid_kd = 100.397
pid_deriv_time = 120
target_temp = 40
max_speed = 1.0
min_speed = 0
gcode_id = STEPPER_LEFT

[temperature_fan Stepper_Righ]
pin = PC7
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.3
sensor_type = Generic 3950
min_temp = 0
max_temp = 100
sensor_pin = thermexp:PA2
pullup_resistor = 4700
control = pid
pid_kp = 28.182
pid_ki = 1.978
pid_kd = 100.397
pid_deriv_time = 120
target_temp = 40
max_speed = 1.0
min_speed = 0
gcode_id = STEPPER_RIGHT

[temperature_fan electronics_bay]
pin = pi:gpio24
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.2
sensor_type = Generic 3950
min_temp = 0
max_temp = 100
sensor_pin = thermexp:PA6
pullup_resistor = 4700
control = pid
pid_kp = 28.182
pid_ki = 1.978
pid_kd = 100.397
pid_deriv_time = 120
target_temp = 30
max_speed = 1.0
min_speed = 0
gcode_id = ELECTRONICSBAY

[controller_fan Skr_cooling_fan]
pin = PB15
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.2
idle_timeout = 60
idle_speed = 1
stepper = stepper_x, stepper_y, stepper_z

[fan_generic boostFans]
pin = pi:gpio17
max_power = 1
shutdown_speed = 0
kick_start_time = 0.1
off_below = 0.2

[gcode_macro _POWER_OFF_PRINTER]
gcode = 
	{action_call_remote_method("set_device_power",
	device="mainpower",
	state="off")}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[output_pin BEEPER_pin]
pin = pi:gpio25
pwm = True
value = 0
shutdown_value = 0
cycle_time = 0.001

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER_pin VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER_pin VALUE=0

[pause_resume]

[display_status]

[force_move]
enable_force_move = true

[respond]
default_type = echo

[mcu pi]
serial = /tmp/klipper_host_mcu

[mcu]
serial = /dev/serial/by-id/usb-Klipper_stm32g0b1xx_320045000750414235363020-if00

[mcu thermexp]
serial = /dev/serial/by-id/usb-Klipper_stm32f042x6_2A0010001343303358333420-if00

[mcu can0]
canbus_uuid = c75d15f53ea9

[virtual_sdcard]
path = /home/pi/printer_data/gcodes
on_error_gcode = 
	SET_LED LED=hat GREEN=0 BLUE=0 RED=1
	SET_LED LED=underglow GREEN=0 BLUE=0 RED=1
	M300 P1000 S11
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="Error_detected"

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 10000
max_accel_to_decel = 10000
max_z_velocity = 15
max_z_accel = 350
square_corner_velocity = 5.0

[safe_z_home]
home_xy_position = 120,120
speed = 20

[input_shaper]
shaper_freq_x = 73
shaper_type_x = mzv
shaper_freq_y = 73
shaper_type_y = 2hump_ei

[stepper_x]
step_pin = PB13
dir_pin = PB12
enable_pin = !PB14
rotation_distance = 40
microsteps = 32
full_steps_per_rotation = 200
endstop_pin = can0:PB6
position_endstop = 120
position_min = 0
position_max = 120
homing_speed = 20
homing_retract_dist = 5
homing_positive_dir = true

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
interpolate = False
run_current = 0.9
sense_resistor = 0.110
stealthchop_threshold = 0

[stepper_y]
step_pin = PB10
dir_pin = PB2
enable_pin = !PB11
rotation_distance = 40
microsteps = 32
full_steps_per_rotation = 200
endstop_pin = ^PC1
position_endstop = 120
position_min = 0
position_max = 120
homing_speed = 20
homing_retract_dist = 5
homing_positive_dir = true

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
interpolate = False
run_current = 0.9
sense_resistor = 0.110
stealthchop_threshold = 0

[stepper_z]
step_pin = PB0
dir_pin = !PC5
enable_pin = !PB1
rotation_distance = 8
microsteps = 32
endstop_pin = ^PC2
position_endstop = 0
position_min = 0
position_max = 117
homing_speed = 10
second_homing_speed = 3.0
homing_retract_dist = 3.0

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
interpolate = False
run_current = 0.4
sense_resistor = 0.110
stealthchop_threshold = 0

[extruder]
step_pin = can0:PD0
dir_pin = !can0:PD1
enable_pin = !can0:PD2
rotation_distance = 21.97079464052595
gear_ratio = 50:10
microsteps = 32
full_steps_per_rotation = 200
max_extrude_only_distance = 1400.0
max_extrude_only_velocity = 75.0
max_extrude_only_accel = 1500
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = can0:PB13
sensor_type = MAX31865
sensor_pin = can0:PA4
spi_bus = spi1
rtd_nominal_r = 100
rtd_reference_r = 430
rtd_num_of_wires = 2
min_extrude_temp = 0
min_temp = 0
max_temp = 300
control = pid
pid_kp = 26.751
pid_ki = 1.858
pid_kd = 96.302

[tmc2209 extruder]
uart_pin = can0:PA15
stealthchop_threshold = 0
run_current = 0.65

[heater_bed]
heater_pin = PC9
sensor_type = Generic 3950
sensor_pin = PC4
smooth_time = 3.0
min_temp = 0
max_temp = 120
pwm_cycle_time = 0.0166
control = pid
pid_kp = 57.122
pid_ki = 2.591
pid_kd = 314.888

[heater_fan hotend_fan]
pin = can0:PA1
max_power = 1.0
kick_start_time = 0.5
heater = extruder
heater_temp = 50.0

[fan]
pin = can0:PA0
kick_start_time = 0.25
cycle_time = 0.15
off_below = 0.10

[idle_timeout]
timeout = 1800

[bed_screws]
screw1 = 61.5,5.8
screw1_name = front screw
screw2 = 6.5,117
screw2_name = back left
screw3 = 117.5,117.5
screw3_name = back right
=======================
Loaded MCU 'mcu' 91 commands (v0.10.0-291-g4ce2d379 / gcc: (15:9-2019-q4-0ubuntu1) 9.2.1 20191025 (release) [ARM/arm-9-branch revision 277599] binutils: (2.34-4ubuntu1+13ubuntu1) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PF1,PF0 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=64000000 MCU=stm32g0b1xx RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PF0,PF1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'mcu' (1024 moves)
Loaded MCU 'pi' 111 commands (v0.10.0-613-gebc3b0de / gcc: (Raspbian 8.3.0-6+rpi1) 8.3.0 binutils: (GNU Binutils for Raspbian) 2.31.1)
MCU 'pi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
Configured MCU 'pi' (1024 moves)
Loaded MCU 'thermexp' 102 commands (v0.10.0-635-gcfb633a0 / gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-11+rpi1+11) 2.31.1)
MCU 'thermexp' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1_PB6_PB7=PB6,PB7 BUS_PINS_i2c1_PB8_PB9=PB8,PB9 BUS_PINS_i2c1_PF1_PF0=PF1,PF0 BUS_PINS_i2c1a=PF1,PF0 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 CLOCK_FREQ=48000000 MCU=stm32f042x6 RESERVE_PINS_USB=PA11,PA12 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
Configured MCU 'thermexp' (1024 moves)
Args: ['/home/pi/klipper/klippy/klippy.py', '/home/pi/klipper_config/printer.cfg', '-l', '/home/pi/klipper_logs/klippy.log', '-a', '/tmp/klippy_uds']
Git version: 'v0.10.0-635-gcfb633a0'
CPU: 4 core ARMv7 Processor rev 3 (v7l)
Python: '3.7.3 (default, Jan 22 2021, 20:04:44) \n[GCC 8.3.0]'
webhooks client 3039683312: {'program': 'Moonraker', 'version': 'v0.7.1-773-g362bc1a'}
=============== Log rollover at Sat Nov 26 00:00:01 2022 ===============
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
b'Got error -1 in can write: (105)No buffer space available'
Unable to issue reset command on MCU 'mcu'
Attempting MCU 'pi' config_reset command
b'Got EOF when reading from device'
Attempting MCU 'thermexp' reset command
Unable to issue reset command on MCU 'can0'
webhooks client 3039683312: Disconnected
Restarting printer
Start printer at Sat Nov 26 00:24:51 2022 (1669443891.2 41907.9)
===== Config file =====
[adxl345]
cs_pin = can0:PB12
spi_software_sclk_pin = can0:PB10
spi_software_mosi_pin = can0:PB11
spi_software_miso_pin = can0:PB2
axes_map = x,y,z

[resonance_tester]
accel_chip = adxl345
probe_points = 
	60,60,20

[neopixel hat]
pin = PA8
chain_count = 18
color_order = GRB

[gcode_macro HAT_ON]
gcode = 
	SET_LED LED=hat GREEN=1 BLUE=1 RED=1

[gcode_macro HAT_OFF]
gcode = 
	SET_LED LED=hat GREEN=0 BLUE=0 RED=0

[neopixel underglow]
pin = PD5
chain_count = 24
color_order = GRB

[gcode_macro UNDERGLOW_ON]
gcode = 
	SET_LED LED=underglow GREEN=1 BLUE=1 RED=1

[gcode_macro UNDERGLOW_OFF]
gcode = 
	SET_LED LED=underglow GREEN=0 BLUE=0 RED=0

[gcode_macro NEOPIXEL_DISPLAY]
gcode = 
	{% set led = params.LED %}
	{% set type = params.TYPE %}
	{% set mode = params.MODE %}
	{% set my_neopixel = printer.configfile.config['neopixel ' ~ led] %}
	
	{% if mode == 'progress' %}
	{% for i in range(my_neopixel.chain_count|int) %}
	SET_LED_TEMPLATE LED={led} INDEX={i+1} TEMPLATE={'led_' ~ type ~ '_' ~ mode} param_led_num={i+1} param_led_total={my_neopixel.chain_count|int}
	{% endfor %}
	{% endif %}
	{% if mode == 'glow' %}
	SET_LED_TEMPLATE LED={led} TEMPLATE={'led_' ~ type ~ '_' ~ mode}
	{% endif %}

[display_template led_extruder_temp_glow]
text = 
	{% if printer.extruder.target > 0.0 %}
	{%  set temp = printer.extruder.target %}
	{% else %}
	{% set temp = printer.configfile.config.extruder.max_temp %}
	{% endif %}
	{% set ratio = printer.extruder.temperature / temp|float %}
	{ratio}, 0.0, {1-ratio}, 0.0

[display_template led_extruder_temp_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% if printer.extruder.target > 0.0 %}
	{%  set temp = printer.extruder.target %}
	{% else %}
	{% set temp = printer.configfile.config.extruder.max_temp %}
	{% endif %}
	{% set ratio = printer.extruder.temperature / temp|float %}
	{% set led_ratio = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	{led_ratio}, 0.0, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[display_template led_bed_temp_glow]
text = 
	{% if printer.heater_bed.target > 0.0 %}
	{%  set temp = printer.heater_bed.target %}
	{% else %}
	{% set temp = printer.configfile.config.heater_bed.max_temp %}
	{% endif %}
	{% set ratio = printer.heater_bed.temperature / temp|float %}
	{ratio}, 0.0, {1-ratio}, 0.0

[display_template led_bed_temp_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% if printer.heater_bed.target > 0.0 %}
	{%  set temp = printer.heater_bed.target %}
	{% else %}
	{% set temp = printer.configfile.config.heater_bed.max_temp %}
	{% endif %}
	{% set ratio = printer.heater_bed.temperature / temp|float %}
	{% set led_ratio = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	{led_ratio}, 0.0, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[display_template led_print_percent_glow]
text = 
	{% set ratio = printer.virtual_sdcard.progress %}
	0.0, {ratio}, 0.0, 0.0

[display_template led_print_percent_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% set ratio = printer.virtual_sdcard.progress %}
	{% set led_ratio   = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	0.0, {led_ratio}, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[display_template led_printer_speed_glow]
text = 
	{% set ratio  = printer.motion_report.live_velocity|float /  printer.configfile.config.printer.max_velocity|float %}
	0.0, {ratio}, 0.0, 0.0

[display_template led_printer_speed_progress]
param_led_num = 0
param_led_total = 1
text = 
	{% set ratio  = printer.motion_report.live_velocity|float /  printer.configfile.config.printer.max_velocity|float %}
	{% set led_ratio    = param_led_num|float / param_led_total %}
	{% if ratio > led_ratio %}
	0.0, {led_ratio}, 0.0, 0.0
	{% else %}
	0.0, 0.0, 0.0, 0.0
	{% endif %}

[gcode_macro _PRINT_START]
gcode = 
	{% set bedtemp = params.BED|int %}
	{% set hotendtemp = params.HOTEND|int %}
	{% set filament_profile = params.FILID|string %}
	G21
	G90
	M83
	G28
	G1 Z20 F1000
	M190 S{bedtemp}
	M109 S{hotendtemp}
	G28 Z
	_PRIME_LINE
	RESPOND TYPE=command MSG="Print start"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_starting"
	
	
	{% if filament_profile == 'PLA_LOUD' %}
	SET_PRESSURE_ADVANCE ADVANCE=0.045
	SET_FAN_SPEED FAN=boostFans SPEED=100
	RESPOND TYPE=command MSG="{filament_profile} - Boost fans 100%"
	{% elif filid == 'PLA_STANDARD' %}
	SET_PRESSURE_ADVANCE ADVANCE=0.045
	SET_FAN_SPEED FAN=boostFans SPEED=0
	RESPOND TYPE=command MSG="{filament_profile} - Boost fans 0%"
	{% elif filid == 'ABS' %}
	SET_FAN_SPEED FAN=boostFans SPEED=0
	RESPOND TYPE=command MSG="{filament_profile} - Boost fans 100%"
	{% endif %}
	
	NEOPIXEL_DISPLAY LED=underglow TYPE=print_percent MODE=progress

[gcode_macro _PRINT_END]
gcode = 
	M400
	G92 E0
	G1 E-4.0 F3600
	G91
	SET_FAN_SPEED FAN=boostFans SPEED=0
	RESPOND TYPE=command MSG="Print end"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_done"
	NEOPIXEL_DISPLAY LED=underglow TYPE=print_percent MODE=glow
	
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 20) %}
	{% set z_safe = 20 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	G0 Z{z_safe} F3600
	G0 X{x_safe} Y{y_safe} F20000
	TURN_OFF_HEATERS
	M107
	G90
	G0 X60 Y{max_y} F3600
	DISABLE_STEPPERS
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30

[gcode_macro PAUSE]
rename_existing = PAUSE_BASE
gcode = 
	PAUSE_BASE
	_TOOLHEAD_PARK_PAUSE_CANCEL
	RESPOND TYPE=command MSG="Print pause"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_paused"

[gcode_macro RESUME]
rename_existing = RESUME_BASE
gcode = 
	
	{% set extrude = printer['gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL'].extrude %}
	
	{% if 'VELOCITY' in params|upper %}
	{% set get_params = ('VELOCITY=' + params.VELOCITY)  %}
	{%else %}
	{% set get_params = "" %}
	{% endif %}
	
	{% if printer.extruder.can_extrude|lower == 'true' %}
	M83
	G1 E{extrude} F2100
	{% if printer.gcode_move.absolute_extrude |lower == 'true' %} M82 {% endif %}
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	RESUME_BASE {get_params}
	RESPOND TYPE=command MSG="Print resume"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_resuming"

[gcode_macro CANCEL_PRINT]
description = Cancel the actual running print
rename_existing = CANCEL_PRINT_BASE
variable_park = True
gcode = 
	
	
	{% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
	{% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
	{% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
	
	G90
	
	
	{% if printer.toolhead.position.x < (max_x - 20) %}
	{% set x_safe = 20.0 %}
	{% else %}
	{% set x_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.y < (max_y - 20) %}
	{% set y_safe = 20.0 %}
	{% else %}
	{% set y_safe = -20.0 %}
	{% endif %}
	
	{% if printer.toolhead.position.z < (max_z - 20) %}
	{% set z_safe = 20 %}
	{% else %}
	{% set z_safe = max_z - printer.toolhead.position.z %}
	{% endif %}
	
	G0 Z{z_safe} F3600
	M107
	G0 X60 Y{max_y} F3600
	DISABLE_STEPPERS
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=30
	SET_FAN_SPEED FAN=boostFans SPEED=0
	{% if printer.pause_resume.is_paused|lower == 'false' and park|lower == 'true'%}
	_TOOLHEAD_PARK_PAUSE_CANCEL
	{% endif %}
	TURN_OFF_HEATERS
	SDCARD_RESET_FILE
	CANCEL_PRINT_BASE
	RESPOND TYPE=command MSG="Print cancel"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="print_cancelled"

[gcode_macro _TOOLHEAD_PARK_PAUSE_CANCEL]
description = Helper: park toolhead used in PAUSE and CANCEL_PRINT
variable_extrude = 1.0
gcode = 
	
	
	{% set x_park = printer.toolhead.axis_maximum.x|float - 5.0 %}
	{% set y_park = printer.toolhead.axis_maximum.y|float - 5.0 %}
	{% set z_park_delta = 2.0 %}
	
	{% set max_z = printer.toolhead.axis_maximum.z|float %}
	{% set act_z = printer.toolhead.position.z|float %}
	{% if act_z < (max_z - z_park_delta) %}
	{% set z_safe = z_park_delta %}
	{% else %}
	{% set z_safe = max_z - act_z %}
	{% endif %}
	
	{% if printer.extruder.can_extrude|lower == 'true' %}
	M83
	G1 E-{extrude} F2100
	{% if printer.gcode_move.absolute_extrude |lower == 'true' %} M82 {% endif %}
	{% else %}
	{action_respond_info("Extruder not hot enough")}
	{% endif %}
	{% if "xyz" in printer.toolhead.homed_axes %}
	G91
	G1 Z{z_safe} F900
	G90
	G1 X{x_park} Y{y_park} F6000
	{% if printer.gcode_move.absolute_coordinates|lower == 'false' %} G91 {% endif %}
	{% else %}
	{action_respond_info("Printer not homed")}
	{% endif %}

[gcode_macro DISABLE_STEPPERS]
description = Disable the steppers
gcode = 
	M18
	RESPOND TYPE=command MSG="Steppers disabled"

[gcode_macro LOAD_FILAMENT]
gcode = 
	M83
	G1 E30 F300
	G1 E15 F150
	M82
	RESPOND TYPE=command MSG="Load filament"

[gcode_macro UNLOAD_FILAMENT]
gcode = 
	M83
	G1 E10 F300
	G1 E-40 F1800
	M82
	RESPOND TYPE=command MSG="Unload filament"

[gcode_macro _TALKETEMP]
gcode = 
	{% set TEMPE = params.TEMPE|int %}
	RESPOND TYPE=command MSG="Extruder temperature: {TEMPE}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="extruder_temperature_{TEMPE}"

[gcode_macro _TALKBTEMP]
gcode = 
	{% set TEMPB = params.TEMPB|int %}
	RESPOND TYPE=command MSG="Bed temperature: {TEMPB}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="bed_temperature_{TEMPB}"

[gcode_macro _TALKFILSET]
gcode = 
	{% set FILSET = params.FILSET|string %}
	RESPOND TYPE=command MSG="Slicer profile: {FILSET}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="slicer_filament_settings_{FILSET}"

[gcode_macro _TALKLHEIGHT]
gcode = 
	{% set LHEIGHT = params.LHEIGHT|string %}
	RESPOND TYPE=command MSG="Layer height: {LHEIGHT}"
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="layer_height_{LHEIGHT}"

[gcode_shell_command SPEAK]
command = espeak
timeout = 30
verbose = false

[delayed_gcode connected]
initial_duration = 1
gcode = 
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="Printer_ready"

[gcode_macro LOWERBED]
gcode = 
	G28
	G1 Z10 F1000

[gcode_macro _PRIME_LINE]
gcode = 
	M117 Prime Line
	G92 E0
	
	G1 Z2.0 F1000
	
	G1 X120 Y120 Z0.28 F5000.0
	G1 X5 Y120 Z0.28 F1500.0 E15
	G1 X5 Y120 Z0.28 F5000.0
	G1 X120 Y120 Z0.28 F1500.0 E30
	G92 E0
	G1 Z2.0 F1000

[temperature_sensor raspberry_pi]
sensor_type = temperature_host
min_temp = 0
max_temp = 100

[temperature_sensor SKR_temp]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 100

[temperature_sensor thermexp]
sensor_type = temperature_mcu
sensor_mcu = thermexp
min_temp = 0
max_temp = 100

[temperature_sensor toolhead_MCU]
sensor_type = temperature_mcu
sensor_mcu = can0
min_temp = 0
max_temp = 100

[temperature_sensor chamber]
sensor_type = Generic 3950
sensor_pin = thermexp:PA3
min_temp = 0
max_temp = 100

[temperature_fan Stepper_Left]
pin = PC6
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.3
sensor_type = Generic 3950
min_temp = 0
max_temp = 100
sensor_pin = thermexp:PA5
pullup_resistor = 4700
control = pid
pid_kp = 28.182
pid_ki = 1.978
pid_kd = 100.397
pid_deriv_time = 120
target_temp = 40
max_speed = 1.0
min_speed = 0
gcode_id = STEPPER_LEFT

[temperature_fan Stepper_Righ]
pin = PC7
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.3
sensor_type = Generic 3950
min_temp = 0
max_temp = 100
sensor_pin = thermexp:PA2
pullup_resistor = 4700
control = pid
pid_kp = 28.182
pid_ki = 1.978
pid_kd = 100.397
pid_deriv_time = 120
target_temp = 40
max_speed = 1.0
min_speed = 0
gcode_id = STEPPER_RIGHT

[temperature_fan electronics_bay]
pin = pi:gpio24
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.2
sensor_type = Generic 3950
min_temp = 0
max_temp = 100
sensor_pin = thermexp:PA6
pullup_resistor = 4700
control = pid
pid_kp = 28.182
pid_ki = 1.978
pid_kd = 100.397
pid_deriv_time = 120
target_temp = 30
max_speed = 1.0
min_speed = 0
gcode_id = ELECTRONICSBAY

[controller_fan Skr_cooling_fan]
pin = PB15
max_power = 1
shutdown_speed = 0
kick_start_time = 1
off_below = 0.2
idle_timeout = 60
idle_speed = 1
stepper = stepper_x, stepper_y, stepper_z

[fan_generic boostFans]
pin = pi:gpio17
max_power = 1
shutdown_speed = 0
kick_start_time = 0.1
off_below = 0.2

[gcode_macro _POWER_OFF_PRINTER]
gcode = 
	{action_call_remote_method("set_device_power",
	device="mainpower",
	state="off")}

[delayed_gcode POWER_OFF_PRINTER_CHECK]
gcode = 
	{% if printer.idle_timeout.state == "Idle" or printer.idle_timeout.state == "Ready" %}
	{% if printer.extruder.temperature < 50.0 and printer.heater_bed.temperature < 50.0 %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	_POWER_OFF_PRINTER
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% endif %}
	{% else %}
	{% if printer.idle_timeout.state == "Printing" %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% else %}
	{% if printer.extruder.target == 0.0 and printer.heater_bed.target == 0.0 %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=2
	{% else %}
	UPDATE_DELAYED_GCODE ID=POWER_OFF_PRINTER_CHECK DURATION=0
	{% endif %}
	{% endif %}
	{% endif %}
	{% endif %}

[output_pin BEEPER_pin]
pin = pi:gpio25
pwm = True
value = 0
shutdown_value = 0
cycle_time = 0.001

[gcode_macro M300]
gcode = 
	
	{% set S = params.S|default(1000)|int %}
	
	{% set P = params.P|default(100)|int %}
	SET_PIN PIN=BEEPER_pin VALUE=0.5 CYCLE_TIME={ 1.0/S if S > 0 else 1 }
	G4 P{P}
	SET_PIN PIN=BEEPER_pin VALUE=0

[pause_resume]

[display_status]

[force_move]
enable_force_move = true

[respond]
default_type = echo

[mcu pi]
serial = /tmp/klipper_host_mcu

[mcu]
serial = /dev/serial/by-id/usb-Klipper_stm32g0b1xx_320045000750414235363020-if00

[mcu thermexp]
serial = /dev/serial/by-id/usb-Klipper_stm32f042x6_2A0010001343303358333420-if00

[mcu can0]
canbus_uuid = c75d15f53ea9

[virtual_sdcard]
path = /home/pi/printer_data/gcodes
on_error_gcode = 
	SET_LED LED=hat GREEN=0 BLUE=0 RED=1
	SET_LED LED=underglow GREEN=0 BLUE=0 RED=1
	M300 P1000 S11
	RUN_SHELL_COMMAND CMD=SPEAK PARAMS="Error_detected"

[printer]
kinematics = corexy
max_velocity = 300
max_accel = 10000
max_accel_to_decel = 10000
max_z_velocity = 15
max_z_accel = 350
square_corner_velocity = 5.0

[safe_z_home]
home_xy_position = 120,120
speed = 20

[input_shaper]
shaper_freq_x = 73
shaper_type_x = mzv
shaper_freq_y = 73
shaper_type_y = 2hump_ei

[stepper_x]
step_pin = PB13
dir_pin = PB12
enable_pin = !PB14
rotation_distance = 40
microsteps = 32
full_steps_per_rotation = 200
endstop_pin = can0:PB6
position_endstop = 120
position_min = 0
position_max = 120
homing_speed = 20
homing_retract_dist = 5
homing_positive_dir = true

[tmc2209 stepper_x]
uart_pin = PC11
tx_pin = PC10
uart_address = 0
interpolate = False
run_current = 0.9
sense_resistor = 0.110
stealthchop_threshold = 0

[stepper_y]
step_pin = PB10
dir_pin = PB2
enable_pin = !PB11
rotation_distance = 40
microsteps = 32
full_steps_per_rotation = 200
endstop_pin = ^PC1
position_endstop = 120
position_min = 0
position_max = 120
homing_speed = 20
homing_retract_dist = 5
homing_positive_dir = true

[tmc2209 stepper_y]
uart_pin = PC11
tx_pin = PC10
uart_address = 2
interpolate = False
run_current = 0.9
sense_resistor = 0.110
stealthchop_threshold = 0

[stepper_z]
step_pin = PB0
dir_pin = !PC5
enable_pin = !PB1
rotation_distance = 8
microsteps = 32
endstop_pin = ^PC2
position_endstop = 0
position_min = 0
position_max = 117
homing_speed = 10
second_homing_speed = 3.0
homing_retract_dist = 3.0

[tmc2209 stepper_z]
uart_pin = PC11
tx_pin = PC10
uart_address = 1
interpolate = False
run_current = 0.4
sense_resistor = 0.110
stealthchop_threshold = 0

[extruder]
step_pin = can0:PD0
dir_pin = !can0:PD1
enable_pin = !can0:PD2
rotation_distance = 21.97079464052595
gear_ratio = 50:10
microsteps = 32
full_steps_per_rotation = 200
max_extrude_only_distance = 1400.0
max_extrude_only_velocity = 75.0
max_extrude_only_accel = 1500
nozzle_diameter = 0.400
filament_diameter = 1.750
heater_pin = can0:PB13
sensor_type = MAX31865
sensor_pin = can0:PA4
spi_bus = spi1
rtd_nominal_r = 100
rtd_reference_r = 430
rtd_num_of_wires = 2
min_extrude_temp = 0
min_temp = 0
max_temp = 300
control = pid
pid_kp = 26.751
pid_ki = 1.858
pid_kd = 96.302

[tmc2209 extruder]
uart_pin = can0:PA15
stealthchop_threshold = 0
run_current = 0.65

[heater_bed]
heater_pin = PC9
sensor_type = Generic 3950
sensor_pin = PC4
smooth_time = 3.0
min_temp = 0
max_temp = 120
pwm_cycle_time = 0.0166
control = pid
pid_kp = 57.122
pid_ki = 2.591
pid_kd = 314.888

[heater_fan hotend_fan]
pin = can0:PA1
max_power = 1.0
kick_start_time = 0.5
heater = extruder
heater_temp = 50.0

[fan]
pin = can0:PA0
kick_start_time = 0.25
cycle_time = 0.15
off_below = 0.10

[idle_timeout]
timeout = 1800

[bed_screws]
screw1 = 61.5,5.8
screw1_name = front screw
screw2 = 6.5,117
screw2_name = back left
screw3 = 117.5,117.5
screw3_name = back right
=======================
Extruder max_extrude_ratio=0.266081
mcu 'mcu': Starting serial connect
webhooks client 3038922608: New connection
webhooks client 3038922608: Client info {'program': 'Moonraker', 'version': 'v0.7.1-773-g362bc1a'}
Loaded MCU 'mcu' 91 commands (v0.10.0-291-g4ce2d379 / gcc: (15:9-2019-q4-0ubuntu1) 9.2.1 20191025 (release) [ARM/arm-9-branch revision 277599] binutils: (2.34-4ubuntu1+13ubuntu1) 2.34)
MCU 'mcu' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1a=PF1,PF0 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi3=PB4,PB5,PB3 CLOCK_FREQ=64000000 MCU=stm32g0b1xx RESERVE_PINS_USB=PA11,PA12 RESERVE_PINS_crystal=PF0,PF1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'pi': Starting connect
Loaded MCU 'pi' 111 commands (v0.10.0-613-gebc3b0de / gcc: (Raspbian 8.3.0-6+rpi1) 8.3.0 binutils: (GNU Binutils for Raspbian) 2.31.1)
MCU 'pi' config: ADC_MAX=4095 CLOCK_FREQ=50000000 MCU=linux PCA9685_MAX=4096 PWM_MAX=32768 STATS_SUMSQ_BASE=256
mcu 'thermexp': Starting serial connect
Loaded MCU 'thermexp' 102 commands (v0.10.0-635-gcfb633a0 / gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-11+rpi1+11) 2.31.1)
MCU 'thermexp' config: ADC_MAX=4095 BUS_PINS_i2c1=PB6,PB7 BUS_PINS_i2c1_PB6_PB7=PB6,PB7 BUS_PINS_i2c1_PB8_PB9=PB8,PB9 BUS_PINS_i2c1_PF1_PF0=PF1,PF0 BUS_PINS_i2c1a=PF1,PF0 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 CLOCK_FREQ=48000000 MCU=stm32f042x6 RESERVE_PINS_USB=PA11,PA12 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu 'can0': Starting CAN connect
Created a socket
Loaded MCU 'can0' 107 commands (v0.10.0-635-gcfb633a0 / gcc: (15:7-2018-q2-6) 7.3.1 20180622 (release) [ARM/embedded-7-branch revision 261907] binutils: (2.31.1-11+rpi1+11) 2.31.1)
MCU 'can0' config: ADC_MAX=4095 BUS_PINS_i2c1_PA9_PA10=PA9,PA10 BUS_PINS_i2c1_PB6_PB7=PB6,PB7 BUS_PINS_i2c1_PB8_PB9=PB8,PB9 BUS_PINS_i2c2_PB10_PB11=PB10,PB11 BUS_PINS_i2c2_PB13_PB14=PB13,PB14 BUS_PINS_i2c3_PB3_PB4=PB3,PB4 BUS_PINS_spi1=PA6,PA7,PA5 BUS_PINS_spi1a=PB4,PB5,PB3 BUS_PINS_spi2=PB14,PB15,PB13 BUS_PINS_spi2a=PC2,PC3,PB10 BUS_PINS_spi3=PB4,PB5,PB3 CANBUS_FREQUENCY=1000000 CLOCK_FREQ=64000000 MCU=stm32g0b1xx PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_CAN=PB0,PB1 RESERVE_PINS_crystal=PF0,PF1 STATS_SUMSQ_BASE=256 STEPPER_BOTH_EDGE=1
mcu_temperature 'mcu' nominal base=-268.260870 slope=1305.652174
mcu_temperature 'thermexp' nominal base=335.831533 slope=-707.559395
mcu_temperature 'can0' nominal base=-272.325581 slope=1309.447674
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (1024 moves)
Sending MCU 'pi' printer configuration...
Configured MCU 'pi' (1024 moves)
Sending MCU 'thermexp' printer configuration...
Configured MCU 'thermexp' (1024 moves)
Sending MCU 'can0' printer configuration...
Configured MCU 'can0' (1024 moves)
Starting heater checks for heater_bed
Starting heater checks for extruder
Write g-code response
Traceback (most recent call last):
  File "/home/pi/klipper/klippy/gcode.py", line 446, in _respond_raw
    os.write(self.fd, (msg+"\n").encode())
BlockingIOError: [Errno 11] Resource temporarily unavailable
Stats 41911.0: gcodein=0  mcu: mcu_awake=0.013 mcu_task_avg=0.000020 mcu_task_stddev=0.000050 bytes_write=2039 bytes_read=4735 bytes_retransmit=9 bytes_invalid=0 send_seq=183 receive_seq=183 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999356 pi: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=903 bytes_read=4446 bytes_retransmit=0 bytes_invalid=0 send_seq=119 receive_seq=119 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50001054 adj=50003844 thermexp: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=882 bytes_read=3823 bytes_retransmit=9 bytes_invalid=0 send_seq=106 receive_seq=106 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48008750 adj=48009303 can0: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=1290 bytes_read=4548 bytes_retransmit=0 bytes_invalid=0 send_seq=137 receive_seq=137 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64003739 adj=64005546 raspberry_pi: temp=34.6 SKR_temp: temp=0.0 thermexp: temp=0.0 toolhead_MCU: temp=0.0 chamber: temp=0.0  heater_bed: target=0 temp=0.0 pwm=0.000 sysload=0.25 cputime=5639.541 memavail=7567676 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=0.0 pwm=0.000
webhooks: registering remote method 'shutdown_machine' for connection id: 3038922608
webhooks: registering remote method 'reboot_machine' for connection id: 3038922608
webhooks: registering remote method 'pause_job_queue' for connection id: 3038922608
webhooks: registering remote method 'start_job_queue' for connection id: 3038922608
webhooks: registering remote method 'set_device_power' for connection id: 3038922608
Stats 41912.0: gcodein=0  mcu: mcu_awake=0.013 mcu_task_avg=0.000020 mcu_task_stddev=0.000050 bytes_write=2045 bytes_read=4780 bytes_retransmit=9 bytes_invalid=0 send_seq=184 receive_seq=184 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999298 pi: mcu_awake=0.000 mcu_task_avg=0.000000 mcu_task_stddev=0.000000 bytes_write=909 bytes_read=4462 bytes_retransmit=0 bytes_invalid=0 send_seq=120 receive_seq=120 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50001157 adj=50000312 thermexp: mcu_awake=0.009 mcu_task_avg=0.000022 mcu_task_stddev=0.000037 bytes_write=888 bytes_read=3929 bytes_retransmit=9 bytes_invalid=0 send_seq=107 receive_seq=107 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48005932 adj=48009205 can0: mcu_awake=0.011 mcu_task_avg=0.000015 mcu_task_stddev=0.000028 bytes_write=1296 bytes_read=4609 bytes_retransmit=0 bytes_invalid=0 send_seq=138 receive_seq=138 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64003259 adj=64004245 raspberry_pi: temp=34.6 SKR_temp: temp=24.4 thermexp: temp=34.6 toolhead_MCU: temp=24.5 chamber: temp=21.1  heater_bed: target=0 temp=21.0 pwm=0.000 sysload=0.25 cputime=5639.576 memavail=7567640 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
Stats 41913.0: gcodein=0  mcu: mcu_awake=0.013 mcu_task_avg=0.000020 mcu_task_stddev=0.000050 bytes_write=2051 bytes_read=4883 bytes_retransmit=9 bytes_invalid=0 send_seq=185 receive_seq=185 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999460 pi: mcu_awake=0.003 mcu_task_avg=0.000018 mcu_task_stddev=0.000017 bytes_write=915 bytes_read=4492 bytes_retransmit=0 bytes_invalid=0 send_seq=121 receive_seq=121 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50000408 adj=50000884 thermexp: mcu_awake=0.009 mcu_task_avg=0.000022 mcu_task_stddev=0.000037 bytes_write=894 bytes_read=4170 bytes_retransmit=9 bytes_invalid=0 send_seq=108 receive_seq=108 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48005084 adj=48004910 can0: mcu_awake=0.011 mcu_task_avg=0.000015 mcu_task_stddev=0.000028 bytes_write=1302 bytes_read=4715 bytes_retransmit=0 bytes_invalid=0 send_seq=139 receive_seq=139 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64001460 adj=64003705 raspberry_pi: temp=34.6 SKR_temp: temp=24.5 thermexp: temp=36.0 toolhead_MCU: temp=24.7 chamber: temp=21.0  heater_bed: target=0 temp=21.0 pwm=0.000 sysload=0.25 cputime=5639.609 memavail=7567888 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
Stats 41914.1: gcodein=0  mcu: mcu_awake=0.013 mcu_task_avg=0.000020 mcu_task_stddev=0.000050 bytes_write=2057 bytes_read=4986 bytes_retransmit=9 bytes_invalid=0 send_seq=186 receive_seq=186 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999381 pi: mcu_awake=0.003 mcu_task_avg=0.000018 mcu_task_stddev=0.000017 bytes_write=921 bytes_read=4508 bytes_retransmit=0 bytes_invalid=0 send_seq=122 receive_seq=122 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50000618 adj=49999359 thermexp: mcu_awake=0.009 mcu_task_avg=0.000022 mcu_task_stddev=0.000037 bytes_write=900 bytes_read=4486 bytes_retransmit=9 bytes_invalid=0 send_seq=109 receive_seq=109 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48004057 adj=48003521 can0: mcu_awake=0.011 mcu_task_avg=0.000015 mcu_task_stddev=0.000028 bytes_write=1308 bytes_read=4837 bytes_retransmit=0 bytes_invalid=0 send_seq=140 receive_seq=140 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64001341 adj=64000448 raspberry_pi: temp=34.1 SKR_temp: temp=24.3 thermexp: temp=36.0 toolhead_MCU: temp=24.4 chamber: temp=21.1  heater_bed: target=0 temp=20.7 pwm=0.000 sysload=0.23 cputime=5639.634 memavail=7568408 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
Stats 41915.1: gcodein=0  mcu: mcu_awake=0.013 mcu_task_avg=0.000020 mcu_task_stddev=0.000050 bytes_write=2063 bytes_read=5118 bytes_retransmit=9 bytes_invalid=0 send_seq=187 receive_seq=187 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999287 pi: mcu_awake=0.003 mcu_task_avg=0.000018 mcu_task_stddev=0.000017 bytes_write=927 bytes_read=4524 bytes_retransmit=0 bytes_invalid=0 send_seq=123 receive_seq=123 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50000600 adj=50000331 thermexp: mcu_awake=0.009 mcu_task_avg=0.000022 mcu_task_stddev=0.000037 bytes_write=906 bytes_read=4727 bytes_retransmit=9 bytes_invalid=0 send_seq=110 receive_seq=110 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48003590 adj=48002053 can0: mcu_awake=0.011 mcu_task_avg=0.000015 mcu_task_stddev=0.000028 bytes_write=1314 bytes_read=4957 bytes_retransmit=0 bytes_invalid=0 send_seq=141 receive_seq=141 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64001176 adj=64000791 raspberry_pi: temp=33.6 SKR_temp: temp=24.4 thermexp: temp=36.1 toolhead_MCU: temp=24.5 chamber: temp=20.8  heater_bed: target=0 temp=21.1 pwm=0.000 sysload=0.23 cputime=5639.655 memavail=7568484 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
Stats 41916.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000014 mcu_task_stddev=0.000011 bytes_write=2069 bytes_read=5235 bytes_retransmit=9 bytes_invalid=0 send_seq=188 receive_seq=188 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999250 pi: mcu_awake=0.003 mcu_task_avg=0.000018 mcu_task_stddev=0.000017 bytes_write=933 bytes_read=4540 bytes_retransmit=0 bytes_invalid=0 send_seq=124 receive_seq=124 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50000427 adj=50000664 thermexp: mcu_awake=0.009 mcu_task_avg=0.000022 mcu_task_stddev=0.000037 bytes_write=912 bytes_read=4968 bytes_retransmit=9 bytes_invalid=0 send_seq=111 receive_seq=111 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48003643 adj=48001784 can0: mcu_awake=0.011 mcu_task_avg=0.000015 mcu_task_stddev=0.000028 bytes_write=1320 bytes_read=5063 bytes_retransmit=0 bytes_invalid=0 send_seq=142 receive_seq=142 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64000945 adj=64000968 raspberry_pi: temp=33.6 SKR_temp: temp=24.4 thermexp: temp=36.4 toolhead_MCU: temp=24.6 chamber: temp=21.4  heater_bed: target=0 temp=21.3 pwm=0.000 sysload=0.23 cputime=5639.675 memavail=7568484 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
Stats 41917.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000014 mcu_task_stddev=0.000011 bytes_write=2075 bytes_read=5338 bytes_retransmit=9 bytes_invalid=0 send_seq=189 receive_seq=189 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999211 pi: mcu_awake=0.003 mcu_task_avg=0.000018 mcu_task_stddev=0.000017 bytes_write=939 bytes_read=4556 bytes_retransmit=0 bytes_invalid=0 send_seq=125 receive_seq=125 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50000356 adj=50000406 thermexp: mcu_awake=0.005 mcu_task_avg=0.000015 mcu_task_stddev=0.000015 bytes_write=918 bytes_read=5298 bytes_retransmit=9 bytes_invalid=0 send_seq=112 receive_seq=112 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48003765 adj=48002580 can0: mcu_awake=0.002 mcu_task_avg=0.000012 mcu_task_stddev=0.000015 bytes_write=1326 bytes_read=5199 bytes_retransmit=0 bytes_invalid=0 send_seq=143 receive_seq=143 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64001023 adj=64000751 raspberry_pi: temp=33.6 SKR_temp: temp=24.5 thermexp: temp=36.2 toolhead_MCU: temp=24.6 chamber: temp=21.0  heater_bed: target=0 temp=21.1 pwm=0.000 sysload=0.23 cputime=5639.698 memavail=7568456 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
Stats 41918.1: gcodein=0  mcu: mcu_awake=0.004 mcu_task_avg=0.000014 mcu_task_stddev=0.000011 bytes_write=2081 bytes_read=5470 bytes_retransmit=9 bytes_invalid=0 send_seq=190 receive_seq=190 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=63999177 pi: mcu_awake=0.001 mcu_task_avg=0.000009 mcu_task_stddev=0.000015 bytes_write=945 bytes_read=4585 bytes_retransmit=0 bytes_invalid=0 send_seq=126 receive_seq=126 retransmit_seq=0 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=50000281 adj=50000445 thermexp: mcu_awake=0.005 mcu_task_avg=0.000015 mcu_task_stddev=0.000015 bytes_write=924 bytes_read=5539 bytes_retransmit=9 bytes_invalid=0 send_seq=113 receive_seq=113 retransmit_seq=2 srtt=0.000 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=48003871 adj=48003412 can0: mcu_awake=0.002 mcu_task_avg=0.000012 mcu_task_stddev=0.000015 bytes_write=1332 bytes_read=5319 bytes_retransmit=0 bytes_invalid=0 send_seq=144 receive_seq=144 retransmit_seq=0 srtt=0.001 rttvar=0.000 rto=0.025 ready_bytes=0 stalled_bytes=0 freq=64000872 adj=64001310 raspberry_pi: temp=33.6 SKR_temp: temp=24.6 thermexp: temp=36.0 toolhead_MCU: temp=24.5 chamber: temp=21.1  heater_bed: target=0 temp=21.0 pwm=0.000 sysload=0.23 cputime=5639.723 memavail=7568328 print_time=0.012 buffer_time=0.000 print_stall=0 extruder: target=0 temp=22.1 pwm=0.000
